<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Evergrowth Org Chart</title>

    <!-- Favicon -->
    <link
      rel="icon"
      href="https://cdn.prod.website-files.com/67de9a786ff9ec4a82a4453a/67f6be889df4d0a86c22e5d1_favicon.svg"
      type="image/svg+xml"
    />

    <style>
      :root {
        --bg: #0b0c10;
        --text: #e8eaf0;
        --muted: #a9afbf;

        --wireRadius: 14;

        --card: #141824;
        --card2: rgba(20, 24, 36, 0.96);
        --border: #2b3244;

        --accent: #6ee7ff;
        --agent: #a855f7;

        --wire: rgba(170, 180, 200, 0.38);
        --wireDash: 6 6;

        --shadow: 0 12px 30px rgba(0, 0, 0, 0.35);
        --radius: 14px;

        --deptGap: 120px;
        --nodeGap: 34px;
        --levelGap: 52px;
      }

      * {
        box-sizing: border-box;
      }

      body {
        margin: 0;
        font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial,
          "Apple Color Emoji", "Segoe UI Emoji";
        background:
          radial-gradient(1200px 800px at 30% -10%, rgba(110, 231, 255, 0.10), transparent 60%),
          radial-gradient(900px 600px at 90% 0%, rgba(168, 85, 247, 0.10), transparent 55%),
          var(--bg);
        color: var(--text);
      }

      header {
        position: sticky;
        top: 0;
        z-index: 10;
        backdrop-filter: blur(10px);
        background: rgba(11, 12, 16, 0.65);
        border-bottom: 1px solid rgba(255, 255, 255, 0.06);
      }

      .wrap {
        max-width: 1200px;
        margin: 0 auto;
        padding: 18px 18px;
      }

      h1 {
        font-size: 18px;
        margin: 0;
        letter-spacing: 0.2px;
      }

      .toolbar {
        display: flex;
        gap: 12px;
        align-items: center;
        justify-content: space-between;
        margin-top: 14px;
        flex-wrap: wrap;
      }

      /* Segmented control */
      .seg {
        display: inline-flex;
        background: rgba(255, 255, 255, 0.06);
        border: 1px solid rgba(255, 255, 255, 0.08);
        border-radius: 999px;
        padding: 4px;
        gap: 4px;
      }

      .seg button {
        appearance: none;
        border: 0;
        background: transparent;
        color: var(--muted);
        padding: 8px 12px;
        border-radius: 999px;
        cursor: pointer;
        font-size: 13px;
        transition: background 0.15s ease, color 0.15s ease, transform 0.05s ease;
        white-space: nowrap;
      }

      .seg button:hover {
        color: var(--text);
      }

      .seg button:active {
        transform: translateY(1px);
      }

      .seg button[aria-pressed="true"] {
        background: rgba(110, 231, 255, 0.14);
        color: var(--text);
        box-shadow: inset 0 0 0 1px rgba(110, 231, 255, 0.25);
      }

      .legend {
        display: flex;
        gap: 10px;
        align-items: center;
        color: var(--muted);
        font-size: 12px;
        flex-wrap: wrap;
      }

      .pill {
        display: inline-flex;
        align-items: center;
        gap: 8px;
        background: rgba(255, 255, 255, 0.05);
        border: 1px solid rgba(255, 255, 255, 0.08);
        border-radius: 999px;
        padding: 6px 10px;
      }

      .dot {
        width: 10px;
        height: 10px;
        border-radius: 999px;
        background: var(--accent);
        box-shadow: 0 0 0 3px rgba(110, 231, 255, 0.12);
      }

      .dot.agent {
        background: var(--agent);
        box-shadow: 0 0 0 3px rgba(168, 85, 247, 0.12);
      }

      main .wrap {
        padding-top: 22px;
        padding-bottom: 34px;
      }

      .board {
        background: linear-gradient(180deg, rgba(255, 255, 255, 0.05), rgba(255, 255, 255, 0.02));
        border: 1px solid rgba(255, 255, 255, 0.08);
        border-radius: var(--radius);
        box-shadow: var(--shadow);
        padding: 18px;
        overflow: auto;
        overscroll-behavior: contain;
      }

      /* Chart container */
      .chart {
        position: relative;
        width: max-content;
        min-width: 100%;
        padding: 18px 22px 28px;
      }

      /* SVG wires layer */
      .wires {
        position: absolute;
        inset: 0;
        width: 100%;
        height: 100%;
        pointer-events: none;
        z-index: 1;
      }

      .wires path {
        fill: none;
        stroke: var(--wire);
        stroke-width: 2;
        stroke-linecap: round;
        stroke-linejoin: round;
        stroke-dasharray: var(--wireDash);
      }

      /* Ensure UI blocks mask wires behind them */
      .dept-pill,
      .node {
        position: relative;
        z-index: 2;
      }

      /* Level: CEO */
      .level-0 {
        display: flex;
        justify-content: center;
        margin-bottom: var(--levelGap);
      }

      /* Departments row */
      .departments {
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
        gap: var(--deptGap);
        width: 100%;
        min-width: 1100px;
      }

      .dept {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 18px;
        min-width: 320px;
        flex: 0 0 auto;
      }

      .dept[data-dept="dept-sales"] {
        min-width: 380px;
      }

      .dept[data-dept="dept-cs"] {
        min-width: 360px;
      }

      .dept-pill {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        padding: 8px 14px;
        border-radius: 999px;
        font-size: 12px;
        color: rgba(255, 255, 255, 0.9);
        background: rgba(20, 24, 36, 0.78);
        border: 1px solid rgba(255, 255, 255, 0.12);
        white-space: nowrap;
        margin-top: 10px;
        backdrop-filter: blur(6px);
      }

      /* Node + subtree */
      .node-wrap {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 16px;
      }

      .children {
        display: flex;
        align-items: flex-start;
        justify-content: center;
        gap: var(--nodeGap);
      }

      .children.column {
        flex-direction: column;
        gap: 18px;
      }

      /* Person/agent card */
      .node {
        width: 240px;
        background: var(--card2);
        border: 1px solid var(--border);
        border-radius: 14px;
        box-shadow: 0 8px 18px rgba(0, 0, 0, 0.22);
        padding: 12px 12px;
        transition: transform 0.12s ease, border-color 0.12s ease, box-shadow 0.12s ease;
        cursor: default;
        backdrop-filter: blur(8px);
      }

      .node:hover {
        transform: translateY(-2px);
        border-color: rgba(110, 231, 255, 0.45);
        box-shadow: 0 12px 26px rgba(0, 0, 0, 0.35);
      }

      .node.agent:hover {
        border-color: rgba(168, 85, 247, 0.55);
      }

      /* Label node */
      .node.label {
        width: auto;
        padding: 7px 12px;
        border-radius: 999px;
        background: rgba(255, 255, 255, 0.06);
        border: 1px dashed rgba(255, 255, 255, 0.18);
        box-shadow: none;
      }

      .node.label:hover {
        transform: none;
        box-shadow: none;
        border-color: rgba(255, 255, 255, 0.22);
      }

      .row {
        display: flex;
        align-items: center;
        gap: 10px;
      }

      /* Avatar placeholder */
      .avatar {
        width: 44px;
        height: 44px;
        border-radius: 999px;
        border: 1px solid rgba(255, 255, 255, 0.14);
        background:
          radial-gradient(12px 12px at 30% 25%, rgba(255, 255, 255, 0.12), transparent 60%),
          rgba(255, 255, 255, 0.05);
        overflow: hidden;
        display: grid;
        place-items: center;
        flex: 0 0 auto;
        user-select: none;
      }

      .avatar img {
        width: 100%;
        height: 100%;
        object-fit: cover;
        display: block;
      }

      .avatar .ph {
        font-weight: 700;
        font-size: 12px;
        letter-spacing: 0.3px;
        color: rgba(255, 255, 255, 0.85);
      }

      .avatar.agent {
        border-color: rgba(168, 85, 247, 0.25);
        background:
          radial-gradient(12px 12px at 30% 25%, rgba(168, 85, 247, 0.18), transparent 60%),
          rgba(168, 85, 247, 0.10);
      }

      .text {
        min-width: 0;
        display: flex;
        flex-direction: column;
        gap: 6px;
      }

      .name {
        font-weight: 650;
        font-size: 13px;
        letter-spacing: 0.2px;
        line-height: 1.15;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
      }

      .title {
        color: var(--muted);
        font-size: 12px;
        line-height: 1.2;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
      }

      .meta {
        margin-top: 10px;
        display: flex;
        justify-content: flex-start;
      }

      .badge {
        display: inline-flex;
        align-items: center;
        gap: 6px;
        border-radius: 999px;
        padding: 4px 9px;
        border: 1px solid rgba(255, 255, 255, 0.10);
        background: rgba(255, 255, 255, 0.04);
        font-size: 11px;
        color: rgba(255, 255, 255, 0.78);
      }

      .badge .mini {
        width: 7px;
        height: 7px;
        border-radius: 999px;
        background: var(--accent);
        box-shadow: 0 0 0 2px rgba(110, 231, 255, 0.12);
      }

      .badge.agent .mini {
        background: var(--agent);
        box-shadow: 0 0 0 2px rgba(168, 85, 247, 0.12);
      }

      /* Tooltip */
      .tooltip {
        position: fixed;
        z-index: 1000;
        pointer-events: none;
        max-width: 360px;
        background: rgba(18, 20, 27, 0.95);
        border: 1px solid rgba(255, 255, 255, 0.10);
        border-radius: 14px;
        box-shadow: 0 16px 40px rgba(0, 0, 0, 0.45);
        padding: 12px 12px;
        transform: translate(12px, 12px);
        opacity: 0;
        transition: opacity 0.12s ease;
      }

      .tooltip.show {
        opacity: 1;
      }

      .tooltip h3 {
        margin: 0 0 6px 0;
        font-size: 13px;
        letter-spacing: 0.2px;
      }

      .tooltip .tt-title {
        margin: 0 0 8px 0;
        color: var(--muted);
        font-size: 12px;
      }

      .tooltip .tt-label {
        color: rgba(255, 255, 255, 0.85);
        font-size: 11px;
        letter-spacing: 0.18px;
        text-transform: uppercase;
        margin: 10px 0 4px 0;
      }

      .tooltip .tt-body {
        margin: 0;
        color: rgba(255, 255, 255, 0.85);
        font-size: 12px;
        line-height: 1.45;
        white-space: pre-line;
      }
    </style>
  </head>

  <body>
    <header>
      <div class="wrap">
        <h1>Evergrowth Org Chart</h1>

        <div class="toolbar">
          <div class="seg" role="group" aria-label="Org chart view toggle">
            <button id="btn-humans" aria-pressed="true">1 â€” Humans only</button>
            <button id="btn-agents" aria-pressed="false">2 â€” Agents only</button>
            <button id="btn-combined" aria-pressed="false">3 â€” Combined</button>
          </div>

          <div class="legend" aria-label="Legend">
            <span class="pill"><span class="dot"></span> Human</span>
            <span class="pill"><span class="dot agent"></span> Agent</span>
            <span class="pill">Tip: Hover nodes</span>
          </div>
        </div>
      </div>
    </header>

    <main>
      <div class="wrap">
        <div class="board" id="board">
          <div class="chart" id="chart">
            <svg class="wires" id="wires"></svg>
            <div class="level-0" id="ceoMount"></div>
            <div class="departments" id="deptMount"></div>
          </div>
        </div>
      </div>
    </main>

    <div id="tooltip" class="tooltip" role="tooltip" aria-hidden="true"></div>

    <script>
      /**
       * ==========================
       * DATA â€” EDIT THIS SECTION
       * ==========================
       */

      const HUMANS = {
        ceo: {
          id: "ceo",
          kind: "human",
          name: "JB DaguenÃ©",
          title: "CEO",
          responsibilities: "Company strategy, exec decisions, prioritization, hiring.",
          bio: "Founder/CEO. Owns vision and overall execution."
        },
        departments: [
          {
            id: "dept-pe",
            name: "Product & Engineering",
            members: [
              {
                id: "nauris",
                kind: "human",
                name: "Nauris Dorbe",
                title: "CTO",
                responsibilities: "Engineering leadership, technical strategy, architecture.",
                bio: "Leads Product & Engineering delivery and technical direction.",
                layout: "column",
                children: [
                  {
                    id: "donatas",
                    kind: "human",
                    name: "Donatas MaÅ¡lÄ—ktÄ—nas",
                    title: "Front-end Engineer",
                    responsibilities: "UI implementation, performance, component systems.",
                    bio: "Builds user-facing features and improves UX quality.",
                    layout: "column",
                    children: [
                      {
                        id: "marks",
                        kind: "human",
                        name: "Marks Leidemans",
                        title: "Senior Software Engineer",
                        responsibilities: "Backend systems, reliability, core services.",
                        bio: "Builds and maintains key platform capabilities.",
                        layout: "column",
                        children: [
                          {
                            id: "cosmin",
                            kind: "human",
                            name: "Cosmin Romeo Tanase",
                            title: "Full-stack Engineer",
                            responsibilities: "End-to-end feature delivery across stack.",
                            bio: "Ships features across frontend + backend.",
                            layout: "column",
                            children: [
                              {
                                id: "edvinas",
                                kind: "human",
                                name: "Edvinas Rabikis",
                                title: "Full Stack Engineer",
                                responsibilities: "Product features, integrations, platform improvements.",
                                bio: "Delivers full-stack work across the product."
                              }
                            ]
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                id: "monika",
                kind: "human",
                name: "Monika StaponkutÄ—",
                title: "Head of Product",
                responsibilities: "Product strategy, roadmap, discovery, requirements.",
                bio: "Owns the product direction and cross-functional alignment.",
                layout: "column",
                children: [
                  {
                    id: "chirag",
                    kind: "human",
                    name: "Chirag Patel",
                    title: "UX Design Lead",
                    responsibilities: "Design systems, user research, interaction design.",
                    bio: "Leads product design and user experience."
                  }
                ]
              }
            ]
          },
          {
            id: "dept-ops",
            name: "Operations",
            members: [
              {
                id: "beatrise",
                kind: "human",
                name: "Beatrise Pociute-DaguenÃ©",
                title: "Head of Business Operations",
                responsibilities: "Company ops, finance ops, systems/processes.",
                bio: "Keeps the business running smoothly.",
                layout: "column",
                children: [
                  {
                    id: "ruta",
                    kind: "human",
                    name: "RÅ«ta DorofejevaitÄ—",
                    title: "Senior Accountant",
                    responsibilities: "Accounting operations, close, reporting, compliance.",
                    bio: "Owns day-to-day accounting and financial hygiene."
                  }
                ]
              }
            ]
          },
          {
            id: "dept-cs",
            name: "Customer Success",
            members: [
              {
                id: "diana",
                kind: "human",
                name: "Diana Heisler",
                title: "Head of CS",
                responsibilities: "Customer onboarding, renewals, support, outcomes.",
                bio: "Owns customer success and retention motions."
              },
              {
                id: "mert",
                kind: "human",
                name: "Mert Gencer",
                title: "Solutions Engineer",
                responsibilities: "Technical onboarding, implementations, support escalation.",
                bio: "Bridges product + customer technical needs.",
                layout: "column",
                children: [
                  {
                    id: "suleman",
                    kind: "human",
                    name: "Suleman Mahmud",
                    title: "GTM Ops",
                    responsibilities: "Rev ops support, systems, reporting, process.",
                    bio: "Keeps GTM operations tight and measurable."
                  },
                  {
                    id: "rudolfs",
                    kind: "human",
                    name: "Rudolfs Selga",
                    title: "GTM Ops",
                    responsibilities: "Ops support, tooling, data hygiene, process.",
                    bio: "Supports GTM systems and execution."
                  }
                ]
              }
            ]
          },
          {
            id: "dept-sales",
            name: "Sales",
            members: [
              {
                id: "justin",
                extraDeptIds: ["dept-cs"],
                kind: "human",
                name: "Justas RodzeviÄius",
                title: "Head of RevOps and Client Consulting",
                responsibilities: "RevOps strategy, client consulting delivery, enablement.",
                bio: "Owns RevOps + consulting engagements."
              },
              {
                id: "cody",
                kind: "human",
                name: "Cody Ayres",
                title: "Head of GTM",
                responsibilities: "GTM strategy, pipeline, sales execution.",
                bio: "Owns revenue outcomes and GTM performance."
              },
              {
                id: "magnus",
                kind: "human",
                name: "Magnus Thomsen",
                title: "Senior AE",
                responsibilities: "Pipeline creation, deal execution, customer development.",
                bio: "Drives new business and expansions."
              }
            ]
          },
          {
            id: "dept-mktg",
            name: "Marketing",
            members: [
              {
                id: "james",
                kind: "human",
                name: "James Ince",
                title: "Head of Product Marketing",
                responsibilities: "Messaging, positioning, launches, enablement, competitive.",
                bio: "Owns product marketing strategy and execution."
              }
            ]
          }
        ]
      };

      const AGENTS = {
        ceo: {
          id: "a-ceo",
          kind: "agent",
          name: "Exec Ops Agent",
          title: "Company Orchestrator",
          responsibilities: "Drafts exec updates, summarizes key metrics, surfaces risks and decisions.",
          bio: "Supports leadership cadence and decision-making."
        },
        departments: [
          {
            id: "a-dept-pe",
            name: "Product & Engineering",
            members: [
              {
                id: "a-prod-squad",
                kind: "label",
                name: "Product Idea Squad",
                layout: "column",
                children: [
                  {
                    id: "a-new-request-titler",
                    kind: "agent",
                    name: "New Request Titler",
                    title: "Feature Title Generator",
                    responsibilities:
                      "Ingests the full Slack feature discussion thread and outputs a succinct feature/update title.",
                    bio: "Turns messy threads into crisp, consistent titles."
                  },
                  {
                    id: "a-new-idea-scorer",
                    kind: "agent",
                    name: "New Idea Scorer",
                    title: "Scoring + Fit Assessment",
                    responsibilities:
                      "Scores ideas (out of 5) on: ease of build, strategic alignment, revenue retention impact, new revenue impact.",
                    bio: "Provides a repeatable scoring rubric for prioritization."
                  },
                  {
                    id: "a-prd-drafter",
                    kind: "agent",
                    name: "PRD Drafter",
                    title: "PRD + JTBD + User Stories",
                    responsibilities:
                      "Drafts PRD scope, build requirements, JTBD, and user stories from the initial request context.",
                    bio: "Accelerates discovery â†’ spec quality."
                  },
                  {
                    id: "a-qa-assistant",
                    kind: "agent",
                    name: "QA Assistant",
                    title: "In-App QA Test Writer",
                    responsibilities:
                      "For each shipped feature, scans product structure, infers impacted areas, and drafts in-app QA tests to catch regressions.",
                    bio: "Reduces inadvertent changes by generating smart regression checks."
                  }
                ]
              }
            ]
          },
          {
            id: "a-dept-ops",
            name: "Operations",
            members: [
              {
                id: "a-ops-none",
                kind: "label",
                name: "No agents yet",
                layout: "row",
                children: []
              }
            ]
          },
          {
            id: "a-dept-cs",
            name: "Customer Success",
            members: [
              {
                id: "a-cs-callintel",
                kind: "label",
                name: "Call Intelligence",
                layout: "row",
                children: [
                  {
                    id: "a-red-flag",
                    kind: "agent",
                    name: "Red Flag Agent",
                    title: "Churn + Adoption Risk",
                    responsibilities:
                      "Listens to customer calls and flags churn risks, adoption blockers, and other issues for CS triage.",
                    bio: "Surfaces risk early so CS can act fast."
                  },
                  {
                    id: "a-wins",
                    kind: "agent",
                    name: "Wins Agent",
                    title: "Praise + Momentum",
                    responsibilities:
                      "Listens to customer calls for direct praise and highlights wins for internal celebration.",
                    bio: "Captures positive moments to reinforce whatâ€™s working."
                  }
                ]
              },
              {
                id: "a-cs-solutions",
                kind: "label",
                name: "Solutions & Services",
                layout: "column",
                children: [
                  {
                    id: "a-onboarding-agent",
                    kind: "agent",
                    name: "Onboarding Agent",
                    title: "Tenant Setup + Strategy",
                    responsibilities:
                      "Works with GTM Ops to generate value props, ecosystems, verticals, qualification, research plans, and ideal persona definitions for new tenants.",
                    bio: "Speeds time-to-value for new customers."
                  },
                  {
                    id: "a-mert-assistant",
                    kind: "agent",
                    name: "Post-Meeting Assistant",
                    title: "Summaries + Tasks for Mert",
                    responsibilities:
                      "Creates meeting summaries and assigns to-do tasks to Mert after customer meetings.",
                    bio: "Turns calls into clean next steps."
                  },
                  {
                    id: "a-request-triager",
                    kind: "agent",
                    name: "Customer Request Triager",
                    title: "Services Intake Routing",
                    responsibilities:
                      "Estimates effort for professional services requests and assigns to the relevant GTM Ops consultant.",
                    bio: "Keeps services work scoped and routed correctly."
                  }
                ]
              }
            ]
          },
          {
            id: "a-dept-sales",
            name: "Sales",
            members: [
              {
                id: "a-sales-squad",
                kind: "label",
                name: "Sales Agents",
                layout: "column",
                children: [
                  {
                    id: "a-prospect-qual-9",
                    kind: "agent",
                    name: "Prospect Qualification Agents (x9)",
                    title: "Fit Validation",
                    responsibilities: "Research new prospects to validate if theyâ€™re a strong fit to pursue.",
                    bio: "Filters pipeline toward high-probability accounts."
                  },
                  {
                    id: "a-research-27",
                    kind: "agent",
                    name: "Research Agents (x27)",
                    title: "Buying Intent Signals",
                    responsibilities:
                      "Research prospects for buying intent signals to use in outreach and sales approach.",
                    bio: "Feeds outreach with real triggers and context."
                  },
                  {
                    id: "a-account-planning",
                    kind: "agent",
                    name: "Account Planning Agents",
                    title: "Strategy Briefs",
                    responsibilities:
                      "Distill prospect research + Evergrowth value prop into a best strategy brief for Cody & Magnus.",
                    bio: "Gets AEs up to speed fast with a tight plan."
                  },
                  {
                    id: "a-contact-finder",
                    kind: "agent",
                    name: "Contact Finder",
                    title: "Buyer Discovery",
                    responsibilities:
                      "Finds ideal buyers at qualified prospects, including email & phone numbers.",
                    bio: "Builds the buyer list and contact paths."
                  },
                  {
                    id: "a-play-agents-5",
                    kind: "agent",
                    name: "Play Agents (x5)",
                    title: "Outreach Drafting",
                    responsibilities:
                      "Drafts outreach using buying signals + Evergrowth messaging (emails, call talk tracks, LinkedIn DMs).",
                    bio: "Generates channel-ready messaging tied to intent."
                  }
                ]
              }
            ]
          },
          {
            id: "a-dept-mktg",
            name: "Marketing",
            members: [
              {
                id: "a-pmm-squad",
                kind: "label",
                name: "Product Marketing Agents",
                layout: "column",
                children: [
                  {
                    id: "a-release-planner",
                    kind: "agent",
                    name: "New Release Planner",
                    title: "PMM Execution Planner",
                    responsibilities:
                      "Ingests release tasks and breaks down PMM steps based on feature tier (videos, KB, social, enablement).",
                    bio: "Turns releases into a repeatable launch checklist."
                  },
                  {
                    id: "a-case-study-scout",
                    kind: "agent",
                    name: "Case Study Scout",
                    title: "Interview Candidate Finder",
                    responsibilities:
                      "Listens to customer/prospect calls for quotes indicating strong case study potential.",
                    bio: "Finds stories worth turning into assets."
                  },
                  {
                    id: "a-quote-bank",
                    kind: "agent",
                    name: "Quote Bank",
                    title: "Praise Logger",
                    responsibilities:
                      "Listens to calls for explicit praise/realized benefits and logs them to a Google Sheet quote bank.",
                    bio: "Builds a searchable proof library."
                  },
                  {
                    id: "a-competitor-quote-bank",
                    kind: "agent",
                    name: "Competitor Quote Bank",
                    title: "Competitive Intel Logger",
                    responsibilities:
                      "Logs explicit competitor frustrations/denigrations from calls into a separate quote bank.",
                    bio: "Creates a goldmine of competitive messaging ammo."
                  }
                ]
              }
            ]
          }
        ]
      };

      const COMBINED = deepClone(HUMANS);
      injectAgentsIntoCombined(COMBINED, AGENTS);

      /**
       * ==========================
       * RENDERING
       * ==========================
       */
      const ceoMount = document.getElementById("ceoMount");
      const deptMount = document.getElementById("deptMount");
      const wires = document.getElementById("wires");
      const chart = document.getElementById("chart");
      const board = document.getElementById("board");
      const tooltip = document.getElementById("tooltip");

      const btnHumans = document.getElementById("btn-humans");
      const btnAgents = document.getElementById("btn-agents");
      const btnCombined = document.getElementById("btn-combined");

      const VIEWS = { humans: HUMANS, agents: AGENTS, combined: COMBINED };
      let currentView = "humans";

      btnHumans.addEventListener("click", () => setView("humans"));
      btnAgents.addEventListener("click", () => setView("agents"));
      btnCombined.addEventListener("click", () => setView("combined"));

      function setView(view) {
        currentView = view;
        btnHumans.setAttribute("aria-pressed", view === "humans");
        btnAgents.setAttribute("aria-pressed", view === "agents");
        btnCombined.setAttribute("aria-pressed", view === "combined");
        render(VIEWS[view]);
      }

      render(VIEWS[currentView]);

      window.addEventListener("resize", () => scheduleWires());
      board.addEventListener("scroll", () => scheduleWires(), { passive: true });

      let raf = null;
      function scheduleWires() {
        if (raf) cancelAnimationFrame(raf);
        raf = requestAnimationFrame(drawWires);
      }

      function render(model) {
        ceoMount.innerHTML = "";
        deptMount.innerHTML = "";
        wires.innerHTML = "";

        const edges = [];

        // CEO node
        ceoMount.appendChild(renderNode(model.ceo));

        // Departments row
        for (const dept of model.departments) {
          const deptEl = document.createElement("div");
          deptEl.className = "dept";
          deptEl.dataset.dept = dept.id;

          const pill = document.createElement("div");
          pill.className = "dept-pill";
          pill.textContent = dept.name;
          pill.dataset.nodeId = dept.id;
          deptEl.appendChild(pill);

          // CEO -> dept pill edge
          edges.push([model.ceo.id, dept.id]);

          const members = document.createElement("div");
          members.className = "children";

          for (const m of dept.members) {
            members.appendChild(renderSubtree(m, edges));

            // Primary dept pill -> member edge
            edges.push([dept.id, m.id]);

            // Extra dept pill(s) -> member edge(s)
            if (Array.isArray(m.extraDeptIds)) {
              for (const extraDeptId of m.extraDeptIds) {
                edges.push([extraDeptId, m.id]);
              }
            }
          }

          deptEl.appendChild(members);
          deptMount.appendChild(deptEl);
        }

        bindTooltips();

        chart.__edges = edges;

        sizeSvgToContent();
        requestAnimationFrame(() => requestAnimationFrame(drawWires));
      }

      function renderSubtree(node, edges) {
        const wrap = document.createElement("div");
        wrap.className = "node-wrap";

        wrap.appendChild(renderNode(node));

        if (node.children && node.children.length) {
          const kids = document.createElement("div");
          kids.className = "children" + (node.layout === "column" ? " column" : "");

          for (const child of node.children) {
            kids.appendChild(renderSubtree(child, edges));
            edges.push([node.id, child.id]);
          }

          wrap.appendChild(kids);
        }

        return wrap;
      }

      function renderNode(node) {
        const kind = node.kind || "human";

        if (kind === "label") {
          const label = document.createElement("div");
          label.className = "node label";
          label.dataset.nodeId = node.id;
          label.textContent = node.name || "";
          return label;
        }

        const card = document.createElement("div");
        card.className = "node" + (kind === "agent" ? " agent" : "");
        card.dataset.nodeId = node.id;

        card.dataset.name = node.name || "";
        card.dataset.title = node.title || "";
        card.dataset.responsibilities = node.responsibilities || "";
        card.dataset.bio = node.bio || "";

        const row = document.createElement("div");
        row.className = "row";

        const avatar = document.createElement("div");
        avatar.className = "avatar" + (kind === "agent" ? " agent" : "");

        if (node.avatarUrl) {
          const img = document.createElement("img");
          img.src = node.avatarUrl;
          img.alt = node.name || "Avatar";
          img.loading = "lazy";
          avatar.appendChild(img);
        } else {
          const ph = document.createElement("div");
          ph.className = "ph";
          ph.textContent = kind === "agent" ? "ðŸ¤–" : initials(node.name || "");
          avatar.appendChild(ph);
        }

        const text = document.createElement("div");
        text.className = "text";

        const name = document.createElement("div");
        name.className = "name";
        name.textContent = node.name || "(Unnamed)";

        const title = document.createElement("div");
        title.className = "title";
        title.textContent = node.title || "";

        text.appendChild(name);
        if (node.title) text.appendChild(title);

        row.appendChild(avatar);
        row.appendChild(text);

        const meta = document.createElement("div");
        meta.className = "meta";

        const badge = document.createElement("span");
        badge.className = "badge" + (kind === "agent" ? " agent" : "");
        badge.innerHTML = `<span class="mini"></span><span>${kind === "agent" ? "Agent" : "Human"}</span>`;

        meta.appendChild(badge);

        card.appendChild(row);
        card.appendChild(meta);

        return card;
      }

      /**
       * ==========================
       * WIRES (SVG)
       * ==========================
       */
      function sizeSvgToContent() {
        const w = chart.scrollWidth;
        const h = chart.scrollHeight;
        wires.setAttribute("width", w);
        wires.setAttribute("height", h);
        wires.setAttribute("viewBox", `0 0 ${w} ${h}`);
      }

      function drawWires() {
        if (!chart.__edges) return;

        sizeSvgToContent();
        wires.innerHTML = "";

        const chartRect = chart.getBoundingClientRect();
        const idToEl = {};
        chart.querySelectorAll("[data-node-id]").forEach((el) => {
          idToEl[el.dataset.nodeId] = el;
        });

        const cssR = getComputedStyle(document.documentElement).getPropertyValue("--wireRadius").trim();
        const baseR = Number(cssR) || 14;

        for (const [fromId, toId] of chart.__edges) {
          const a = idToEl[fromId];
          const b = idToEl[toId];
          if (!a || !b) continue;

          const ar = a.getBoundingClientRect();
          const br = b.getBoundingClientRect();

          // chart-local anchors
          const x1 = (ar.left + ar.right) / 2 - chartRect.left;
          const y1 = ar.bottom - chartRect.top;

          const x2 = (br.left + br.right) / 2 - chartRect.left;

          const isDeptPill = b.classList && b.classList.contains("dept-pill");
          const isNodeCard = b.classList && b.classList.contains("node") && !b.classList.contains("label");

          const endPad = isDeptPill ? 18 : isNodeCard ? 14 : 0;
          const y2 = br.top - endPad - chartRect.top;

          // Bus placement:
          // Keep it close to source, but avoid landing behind the target card/pill.
          const preferredBus = y1 + 28;
          const avoidTarget = y2 - 36;
          let midY = Math.min(preferredBus, avoidTarget);

          const hh = Math.abs(x2 - x1);
          const v1 = Math.max(0, midY - y1);
          const v2 = Math.max(0, y2 - midY);

          const rr = Math.max(0, Math.min(baseR, hh / 2, v1 / 2, v2 / 2));
          const minMid = y1 + rr + 4;
          const maxMid = y2 - rr - 4;
          midY = Math.max(minMid, Math.min(maxMid, midY));

          let d;

          if (Math.abs(x2 - x1) < 6) {
            d = `M ${x1} ${y1} V ${y2}`;
          } else {
            const dir = x2 > x1 ? 1 : -1;
            d = `
              M ${x1} ${y1}
              V ${midY - rr}
              Q ${x1} ${midY} ${x1 + rr * dir} ${midY}
              H ${x2 - rr * dir}
              Q ${x2} ${midY} ${x2} ${midY + rr}
              V ${y2}
            `;
          }

          const path = document.createElementNS("http://www.w3.org/2000/svg", "path");
          path.setAttribute("d", d);
          wires.appendChild(path);

          // Drop line onto the element's top edge (dept pill OR node card)
          if (endPad > 0) {
            const drop = document.createElementNS("http://www.w3.org/2000/svg", "path");
            const yTop = br.top - endPad - chartRect.top;
            const yEdge = br.top - chartRect.top;
            drop.setAttribute("d", `M ${x2} ${yTop} V ${yEdge}`);
            wires.appendChild(drop);
          }
        }
      }

      /**
       * ==========================
       * TOOLTIPS
       * ==========================
       */
      function bindTooltips() {
        chart.querySelectorAll(".node:not(.label)").forEach((el) => {
          el.addEventListener("mouseenter", (e) => showTooltip(e.currentTarget, e));
          el.addEventListener("mousemove", (e) => moveTooltip(e));
          el.addEventListener("mouseleave", hideTooltip);
        });
      }

      function showTooltip(el, e) {
        const name = el.dataset.name || "";
        const title = el.dataset.title || "";
        const responsibilities = el.dataset.responsibilities || "";
        const bio = el.dataset.bio || "";

        if (!responsibilities && !bio) return;

        tooltip.innerHTML = `
          <h3>${escapeHtml(name)}</h3>
          ${title ? `<div class="tt-title">${escapeHtml(title)}</div>` : ""}
          ${
            responsibilities
              ? `<div class="tt-label">Responsibilities</div><p class="tt-body">${escapeHtml(
                  responsibilities
                )}</p>`
              : ""
          }
          ${bio ? `<div class="tt-label">Bio</div><p class="tt-body">${escapeHtml(bio)}</p>` : ""}
        `;
        tooltip.classList.add("show");
        tooltip.setAttribute("aria-hidden", "false");
        moveTooltip(e);
      }

      function moveTooltip(e) {
        const pad = 14;
        const rect = tooltip.getBoundingClientRect();
        let x = e.clientX + 14;
        let y = e.clientY + 14;

        if (x + rect.width + pad > window.innerWidth) x = e.clientX - rect.width - 14;
        if (y + rect.height + pad > window.innerHeight) y = e.clientY - rect.height - 14;

        tooltip.style.left = x + "px";
        tooltip.style.top = y + "px";
      }

      function hideTooltip() {
        tooltip.classList.remove("show");
        tooltip.setAttribute("aria-hidden", "true");
      }

      /**
       * ==========================
       * COMBINED VIEW (inject agents)
       * ==========================
       * Places squads under specific humans:
       * - Product squad under Monika
       * - CS Call Intel under Diana
       * - CS Solutions/Services under Mert
       * - PMM squad under James
       * - Sales squad under Cody
       */
      function injectAgentsIntoCombined(humans, agents) {
        function findInTree(node, id) {
          if (!node) return null;
          if (node.id === id) return node;
          if (node.children) {
            for (const c of node.children) {
              const found = findInTree(c, id);
              if (found) return found;
            }
          }
          return null;
        }

        function findHumanNodeById(id) {
          // Search CEO
          const fromCeo = findInTree(humans.ceo, id);
          if (fromCeo) return fromCeo;

          // Search departments
          for (const dept of humans.departments) {
            for (const m of dept.members) {
              const found = findInTree(m, id);
              if (found) return found;
            }
          }
          return null;
        }

        function findAgentMemberById(id) {
          for (const dept of agents.departments) {
            for (const m of dept.members) {
              const found = findInTree(m, id);
              if (found) return found;
            }
          }
          return null;
        }

        function attach(humanId, agentMemberId) {
          const human = findHumanNodeById(humanId);
          const agentNode = findAgentMemberById(agentMemberId);
          if (!human || !agentNode) return;

          human.children = human.children || [];
          human.children.push(deepClone(agentNode));
        }

        attach("monika", "a-prod-squad");
        attach("diana", "a-cs-callintel");
        attach("mert", "a-cs-solutions");
        attach("james", "a-pmm-squad");
        attach("cody", "a-sales-squad");
      }

      /**
       * ==========================
       * UTIL
       * ==========================
       */
      function deepClone(obj) {
        return JSON.parse(JSON.stringify(obj));
      }

      function escapeHtml(str) {
        return String(str)
          .replaceAll("&", "&amp;")
          .replaceAll("<", "&lt;")
          .replaceAll(">", "&gt;")
          .replaceAll('"', "&quot;")
          .replaceAll("'", "&#039;");
      }

      function initials(name) {
        const parts = name.trim().split(/\s+/).filter(Boolean);
        if (!parts.length) return "â€¢";
        const first = parts[0][0] || "";
        const last = parts.length > 1 ? parts[parts.length - 1][0] || "" : "";
        return (first + last).toUpperCase();
      }
    </script>
  </body>
</html>
